### 核心概念
- exchange:接受生产者的消息并把它转到合适的队列
- queue:存储Exchange发来的消息，并将消息主动发送给Consumer或者 Consumer 主动来获取消息 
- binding:确定exchange和queue之间的关系
- channel和connection:生产者和消费者需要和 RabbitMQ 建立 TCP 连接。一些应用需要多个connection，为了节省TCP 连接，可以使用 Channel，它可以被认为是一种轻型的共享 TCP 连接的连接。
连接需要显式关闭。

![架构图](https://github.com/xiazhibin/blog/blob/master/pic/messagequeue.jpg)

```python
import pika

params = pika.URLParameters('amqp://username:password@host')
params.socket_timeout = 5
connection = pika.BlockingConnection(params)
channel = connection.channel()
channel.exchange_declare(exchange='hello_exchanger', exchange_type='direct')
channel.queue_declare(queue='hello')
channel.queue_bind(exchange='hello_exchanger', queue='hello', routing_key='info')
channel.basic_publish(exchange='hello_exchanger',routing_key='info',body='Hello World!2222')
connection.close()

```

```python
import pika

params = pika.URLParameters('amqp://username:password@host')
connection = pika.BlockingConnection(params)
channel = connection.channel()  # start a channel
channel.queue_declare(queue='hello')  # Declare a queue


def callback(ch, method, properties, body):
    print(body)

# set up subscription on the queue
channel.basic_consume(callback, queue='hello', no_ack=True)

# start consuming (blocks)
try:
    channel.start_consuming()
except:
    pass
finally:
    connection.close()
```
